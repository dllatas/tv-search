"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function generate_url(e){return"https://www.omdbapi.com/?i="+e+"&plot=short&r=json"}function get_episodes(e){var t=[];return e.map(function(e,a){t.push(generate_url(e.imdbID))}),t}function get_ranking(e){var t=[];return e.map(function(e,a){t.push(e.imdbRating)}),_mathjs2.default.mean(t).toFixed(2)}function display_data(e){request(e,function(e,t,a){var r,n;if(e)throw new Error(e);t=JSON.parse(t.body),n=get_ranking(t.Episodes),_reactDom2.default.render(_react2.default.createElement(Show,{data:t,ranking:n}),document.getElementById("show")),r=get_episodes(t.Episodes),_bluebird2.default.map(r,function(e){return request.getAsync(e).then(function(e,t){return JSON.parse(e.body)})}).then(function(e){_reactDom2.default.render(_react2.default.createElement(EpisodeList,{episode:e}),document.getElementById("episode"))},function(e){if(e)throw new Error(e)})})}var _react=require("react"),_react2=_interopRequireDefault(_react),_reactDom=require("react-dom"),_reactDom2=_interopRequireDefault(_reactDom),_bluebird=require("bluebird"),_bluebird2=_interopRequireDefault(_bluebird),_moment=require("moment"),_moment2=_interopRequireDefault(_moment),_mathjs=require("mathjs"),_mathjs2=_interopRequireDefault(_mathjs),request=_bluebird2.default.promisifyAll(require("request")),Search=_react2.default.createClass({displayName:"Search",render:function(){return _react2.default.createElement("div",{className:"input-group"},_react2.default.createElement("input",{id:"searchText",type:"text",className:"form-control",placeholder:"Search for ..."}),_react2.default.createElement("span",{className:"input-group-btn"},_react2.default.createElement("button",{id:"searchBtn",className:"btn btn-success",type:"button"},"Search!")))}}),Show=_react2.default.createClass({displayName:"Show",render:function(){return _react2.default.createElement("h1",{className:"text-center"},this.props.data.Title,_react2.default.createElement("h4",{className:"text-center"},"Ranking: ",this.props.ranking))}}),HideButton=_react2.default.createClass({displayName:"HideButton",hideElement:function(e){event.target.parentElement.style.display="none"},componentDidMount:function(){this.refs.bh.addEventListener("click",this.hideElement,!1)},render:function(){return _react2.default.createElement("button",{ref:"bh",type:"button",className:"btn btn-default pull-right hide-episode","aria-label":"Hide"},"Hide")}}),Episode=_react2.default.createClass({displayName:"Episode",render:function(){var e=new Date(this.props.episode.Released);return this.props.episode.imdbRating>=8.5?_react2.default.createElement("li",{className:"list-group-item high-episode",key:this.props.episode.imdbID,id:this.props.episode.imdbID},_react2.default.createElement(HideButton,null),_react2.default.createElement("h2",null," ",this.props.episode.Episode," ",this.props.episode.Title," "),_react2.default.createElement("h3",null," ",this.props.episode.Plot," "),_react2.default.createElement("h2",null," Released: ",(0,_moment2.default)(e).format("MMMM")," "),_react2.default.createElement("h2",null," Rating: ",this.props.episode.imdbRating," "),_react2.default.createElement("img",{className:"img-responsive",src:this.props.episode.Poster})):_react2.default.createElement("li",{className:"list-group-item",key:this.props.episode.imdbID,id:this.props.episode.imdbID},_react2.default.createElement(HideButton,null),_react2.default.createElement("h2",null," ",this.props.episode.Episode," ",this.props.episode.Title," "),_react2.default.createElement("h3",null," ",this.props.episode.Plot," "),_react2.default.createElement("h2",null," Released: ",(0,_moment2.default)(e).format("MMMM")," "),_react2.default.createElement("h2",null," Rating: ",this.props.episode.imdbRating," "),_react2.default.createElement("img",{className:"img-responsive",src:this.props.episode.Poster}))}}),EpisodeList=_react2.default.createClass({displayName:"EpisodeList",render:function(){return _react2.default.createElement("ul",{id:"episodeList",className:"list-group"},this.props.episode.map(function(e){return _react2.default.createElement(Episode,{key:e.imdbID,episode:e})}))}}),options={method:"GET",url:"https://www.omdbapi.com/",qs:{t:"Silicon Valley",Season:"1"},form:{name:"General",abbreviation:"GEN"}};_reactDom2.default.render(_react2.default.createElement(Search,{placeholder:"Search your show here"}),document.getElementById("search")),display_data(options),window.addEventListener("load",function(e){function t(e){options.qs.t=e}function a(){return document.getElementById("searchText").value}function r(){t(a()),display_data(options)}var n=document.getElementById("searchBtn");n&&n.addEventListener("click",r,!1)});